<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>konva.js sample 3 - gif.</title>
    <!-- style.css -->
    <link href="gif3/style.css" rel="stylesheet" type="text/css" />
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <!-- Moment.js -->
    <script src="/dist/js/moment.min.js"></script>
    <!-- gifuctjs -->
    <script src="/dist/js/gifuct-js.min.js"></script>
    <!-- giflerjs -->
    <script src="/dist/js/gifler.min.js"></script>
    <!-- konvajs -->
    <script src="/dist/js/konva.min.js"></script>
    <!-- nlib -->
    <!--
    <script src="/dist/js/nlib.js"></script>
    -->
    <!-- script.js -->
    <script src="gif3/script.js"></script>
    <script>
        console.log('load konva.js gif app.')

        //let asset = '/public/assets/images/gif/anime/anime-01.gif'
        let asset = '/public/assets/images/gif/emoji/transparent/emo-nt-35.gif'
        //let asset = 'https://konvajs.org/assets/yoda.gif'

        let data = {
            "attrs": {"width":578,"height":200},
            "className":"Stage",
            "children":[
                {"attrs":{},
                "className":"Layer",
                "children":[{
                    "attrs":{
                        "width":"auto","height":"auto","text":"Text Shadow!",
                        "fontFamily":"Calibri","fontSize":95,
                        "x":20,"y":20,
                        "stroke":"red","strokeWidth":2,
                        "shadowColor":"black","shadowBlur":2,"shadowOffsetX":10,
                        "shadowOffsetY":10,"shadowOpacity":0.5
                    },
                    "className":"Text"
                }, {
                    "attrs":{
                        "stroke":"green",
                        "strokeWidth":10,
                        "lineJoin":"round","lineCap":"round",
                        "points":[{"x":50,"y":140},{"x":450,"y":160}],
                        "shadowColor":"black","shadowBlur":10,"shadowOffsetX":5,
                        "shadowOffsetY":5,"shadowOpacity":0.5
                    },
                    "className":"Line"
                }, {
                    "attrs":{
                        "x":280,"y":100,"width":100,"height":50,
                        "fill":"#00D2FF","stroke":"black","strokeWidth":4,
                        "shadowColor":"black","shadowBlur":10,"shadowOffsetX":5,
                        "shadowOffsetY":5,"shadowOpacity":0.5,
                        "rotation":0.35,
                        "id":"blueRectangle"
                    },
                    "className":"Rect"
                }, {
                    "attrs":{
                        "x":100,"y":41,"width":106,"height":118,
                        "id":"yodaImage"
                    },
                    "className":"Image"
                }
            ]}
        ]}

        var json = JSON.stringify(data);
        var stage = Konva.Node.create(json, 'container');

        /*
        * set functions
        */
        stage.find('#blueRectangle').on('mouseover mouseout', function () {
            var stroke = this.stroke();
            this.stroke(stroke === 'black' ? 'red' : 'black');
            stage.draw();
        });
        /*
        * set images
        */
        var imageObj = new Image();
        imageObj.onload = function () {
            stage.find('#yodaImage')[0].image(imageObj);
            stage.draw();
        };
        imageObj.src = asset;

    </script>
</body>
</html>